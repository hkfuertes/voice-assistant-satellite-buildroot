#!/bin/sh
DAEMON="wyoming-openwakeword"
PIDFILE="/var/run/$DAEMON.pid"

start() {
    printf "Starting $DAEMON: "
    start-stop-daemon -S -q -b -m -p $PIDFILE \
        -x /usr/bin/wyoming-openwakeword -- \
        --uri "tcp://127.0.0.1:10400"
    [ $? = 0 ] && echo "OK" || echo "FAIL"
}

stop() {
    printf "Stopping $DAEMON: "
    start-stop-daemon -K -q -p $PIDFILE
    [ $? = 0 ] && echo "OK" || echo "FAIL"
    rm -f $PIDFILE
}

case "$1" in
    start) start ;;
    stop) stop ;;
    restart|reload) stop; sleep 1; start ;;
    *) echo "Usage: $0 {start|stop|restart}"; exit 1 ;;
esac